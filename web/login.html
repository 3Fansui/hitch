<!DOCTYPE html>
<html>

<head>
    <title>同城顺风车</title>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/jquery.mobile-1.4.5.min.css">
    <script src="js/jquery-1.11.3.min.js"></script>
    <script src="js/jquery.mobile-1.4.5.min.js"></script>
    <link rel="stylesheet" href="css/common.css" />
    <script type="text/javascript" src="js/common.js"></script>

    <script>
        $(function () {
            var token = localStorage.getItem('SESSION_TOKEN_KEY');
            if (token && token !== 'null' && token !== 'undefined') {
                location.href = 'user/user.html';
                return;
            }

            // 登录
            $('#go').click(function () {
                if ($('#u').val() == '' || $('#p').val() == '') return;
                $.postForm("/account/api/login", '#loginForm', function (d) {
                    if (d.code == 200) {
                        showMsg('登录成功');
                        localStorage.setItem('SESSION_TOKEN_KEY', d.data[0].token);
                        localStorage.setItem('current_role', 0); //默认切换
                        if ($('#isDriver').val() == '1') {
                            toUrl('driver/user.html', 1000);
                        } else {
                            toUrl('user/user.html', 1000); //第一次登陆会进这里
                        }
                    } else {
                        showMsg(d.message);
                    }
                })
            });
            // 注册
            $('#reg').click(function () {
                if ($('#username').val() == '' || $('#password').val() == '' || $('#phone').val() == '') {
                    showMsg('请将信息填写完整！');
                    return;
                }
                if ($('#password').val() != $('#password2').val()) {
                    showMsg('两次密码不一致！');
                    return;
                }
                $.ajax({
                    type: "POST",
                    url: "/account/api/register",
                    cache: false,
                    data: formToJson('#regForm'),
                    success: function (d) {
                        console.log(d);
                        if (d.code == 200) {
                            showMsg('注册成功！');
                            toUrl('login.html', 1000);
                        } else {
                            showMsg(d.message);
                        }
                    }
                });
            });
        });

    </script>
</head>

<body>
    <div data-role="page" id="pageone" class="fullscreen-bg">
        <div data-role="main" class="ui-content" style="padding: 0;">
            <!-- Brand Logo / Title Area -->
            <div style="text-align: center; margin-bottom: 40px; margin-top: -60px;">
                <h1
                    style="color: white; font-size: 32px; font-weight: 800; letter-spacing: 2px; text-shadow: 0 4px 15px rgba(0,0,0,0.6); margin: 0;">
                    同城顺风车</h1>
                <p style="color: rgba(255,255,255,0.7); font-size: 14px; margin-top: 8px;">畅享每一次同城出行</p>
            </div>

            <!-- Glassmorphism Login Form -->
            <div class="glass-login-card">
                <form id="loginForm">
                    <div style="margin-bottom: 25px;">
                        <input name="username" id="u" class="glass-input" autocomplete="off" />
                    </div>
                    <div style="margin-bottom: 35px;">
                        <input name="password" id="p" type="password" class="glass-input" />
                    </div>
                    <button type="button" class="ui-btn-active" id="go"
                        style="padding: 14px !important; font-size: 18px !important; border-radius: 50px !important;">开
                        启 行 程</button>

                    <div style="text-align: center; margin-top: 25px;">
                        <a href="#pagetwo"
                            style="color: rgba(255,255,255,0.8); text-decoration: none; font-size: 14px; font-weight: 500; transition: color 0.3s;"
                            onmouseover="this.style.color='white'"
                            onmouseout="this.style.color='rgba(255,255,255,0.8)'">新面孔？去注册账号 ⟶</a>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Register Page follows similar immersive styling -->
    <div data-role="page" id="pagetwo" class="fullscreen-bg">
        <div data-role="main" class="ui-content" style="padding: 0;">
            <div style="text-align: center; margin-bottom: 30px; margin-top: -30px;">
                <h1
                    style="color: white; font-size: 28px; font-weight: 700; text-shadow: 0 4px 15px rgba(0,0,0,0.6); margin: 0;">
                    创建新账号</h1>
                <p style="color: rgba(255,255,255,0.7); font-size: 14px; margin-top: 8px;">加入同城顺风车网络</p>
            </div>

            <div class="glass-login-card">
                <form id="regForm">
                    <div style="margin-bottom: 15px;">
                        <input name="username" id="username" class="glass-input" placeholder="设置用户名"
                            autocomplete="off" />
                    </div>
                    <div style="margin-bottom: 15px;">
                        <input name="phone" id="phone" class="glass-input" placeholder="输入手机号" type="tel" />
                    </div>
                    <div style="margin-bottom: 15px;">
                        <input name="password" id="password" type="password" class="glass-input" placeholder="设置登录密码" />
                    </div>
                    <div style="margin-bottom: 30px;">
                        <input id="password2" type="password" class="glass-input" placeholder="再次确认密码" />
                    </div>
                    <button type="button" class="ui-btn-active" id="reg"
                        style="padding: 14px !important; font-size: 18px !important; border-radius: 50px !important; background: linear-gradient(135deg, #00c6ff 0%, #0072ff 100%) !important;">注
                        册</button>
                </form>
                <div style="text-align: center; margin-top: 25px;">
                    <a href="#pageone"
                        style="color: rgba(255,255,255,0.8); text-decoration: none; font-size: 14px; font-weight: 500; transition: color 0.3s;"
                        onmouseover="this.style.color='white'" onmouseout="this.style.color='rgba(255,255,255,0.8)'">⟵
                        已有账号？去登录</a>
                </div>
            </div>
        </div>
    </div>
</body>

</html>